{% extends "base.html" %}
{% block content %}
<h2 class="text-xl font-semibold mb-4">Crear pedido</h2>
<form method="post" class="space-y-3">
  <div><label class="block text-sm font-medium">Cliente</label><input class="mt-1 block w-full rounded border px-3 py-2" name="customer_name" required></div>
  <div><label class="block text-sm font-medium">Dirección</label><input class="mt-1 block w-full rounded border px-3 py-2" name="address" required></div>
  <div><label class="block text-sm font-medium">Teléfono</label><input class="mt-1 block w-full rounded border px-3 py-2" name="phone" required></div>

  <h4 class="font-medium">Items</h4>
  <div id="items" class="space-y-2">
    <div class="flex space-x-2">
      <select class="flex-1 rounded border px-3 py-2" name="product_id">{% for p in products %}<option value="{{ p.id }}">{{ p.name }} (stock: {{ p.stock }})</option>{% endfor %}</select>
      <input class="w-24 rounded border px-3 py-2" name="qty" type="number" value="1" min="1">
    </div>
  </div>
  <button type="button" id="add" class="px-3 py-2 bg-gray-100 rounded hover:scale-105 cursor-pointer">Agregar otro</button>

  <div class="flex space-x-2"><button class="px-4 py-2 bg-cyan-500 text-white rounded hover:scale-105 cursor-pointer">Registrar pedido</button><a class="px-4 py-2 border rounded hover:scale-105" href="{{ url_for('products') }}">Cancelar</a></div>
</form>

<script>
document.getElementById('add').addEventListener('click', function(){
  const row = document.querySelector('#items .flex').cloneNode(true);
  row.querySelectorAll('input').forEach(i=>i.value='1');
  document.getElementById('items').appendChild(row);
});
</script>
{% endblock %}
